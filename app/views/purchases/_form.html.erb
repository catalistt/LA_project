<div class="container">
  <div class="row">
    <div class="col-4 offset-1">
      <h1><%= title%></h1><br>
    </div>
  </div>
    <div class="row bg-white borderblue pt-3">
      <div class="col-2">
        <h4 class="ml-3 text-blue">Datos básicos</h4>
      </div>

      <%= form_with(model: purchase, local: true) do |form| %>
        <% if purchase.errors.any? %>
          <div id="error_explanation">
            <h2><%= pluralize(purchase.errors.count, "error") %> prohibited this purchase from being saved:</h2>
            <ul>
            <% purchase.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
            </ul>
          </div>
        <% end %>

          <br>
          <div class="row">
            <div class="col-4 offset-1">
              <div class="field">
                <%= form.label :Fecha, class: "control-label"%><br>
                <%= form.date_select :created_at, {:use_month_names => ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre','Diciembre'], discard_year: true, selected: Date.today}%>
              </div>
            </div>

          <div class="col-4">
            <div class="field">
              <%= form.label :Proveedor, class: "control-label"%><br>
              <%= form.select(:supplier_id, Supplier.all.map {|supplier| ["#{supplier.name} - #{supplier.rut}", supplier.id] }, { :include_blank => 'Ingresar proveedor' }) %>
            </div>
          </div>

          <div class="col-3">
            <div class="field">
              <%= form.label :Folio %><br>
              <%= form.number_field :invoice_number %>
            </div>
          </div>
              
          <div class="form-group">
              <%= form.hidden_field :total_amount, class: "form-control" %>
            </div>
          </div><br>

        <div class="container">
          <div class="row">
            <h4 class="ml-2 text-blue col-10">Agregar productos</h4>
            <div class="field" id="add_items">
              <%= form.fields_for :add_items do |add_item_form| %>
                <%= render 'add_item_fields', f: add_item_form %>
              <% end %>
              <div class="links"><br>
                <%= link_to_add_association 'Añadir nuevo producto', form, :add_items, class:"btn btn-info ml-4" %>
              </div>
            </div>
          </div>
        </div>
          <br>
          <div class="col-3 offset-7">
           <p>Total factura</p>
           <p class="form-control total-purchase"></p>
          </div>
          <br>
          
          <div class="actions offset-1"><br>
            <%= form.submit "Ingresar compra", class:"btn btn-success" %>
          </div><br>
        
      <% end %>
    </div>
    </div>
  </div>
</div>
